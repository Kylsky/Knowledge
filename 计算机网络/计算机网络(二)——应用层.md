# 计算机网络(二)——应用层

## 一、主流网络应用程序体系结构

### 客户-服务器体系结构

### 对等(P2P)体系结构



## 二、进程通信

### 客户与服务器进程

对每对通信进程，通常将这两个进程之一标识为客户(client)，而另一个进程标识为服务器(server)。

### 进程与计算机网络之间的接口

进程通过一个称为套接字(socket)的软件接口向网络发送报文和从网络接收报文

### 进程寻址

再一台主机上运行的进程为了向在另一台主机上运行的进程发送分组，接收进程需要有一个地址。为了接收进程，需要定义两种信息：

1.主机地址

2.在目的主机中指定接收进程的标识符



## 三、供应用程序使用的运输服务

### 要求

**可靠数据传输**

**吞吐量**

**定时**

**安全性**



### 因特网提供的运输服务

#### **TCP服务**

1.面向连接服务。TCP连接是全双工的，即连接双方可以在此连接上同时进行报文收发。

2.可靠数据传输服务。能够依靠TCP连接将相同的字节流交付给接收方的套接字，而没有字节的丢失和冗余。

#### **UDP服务**

不可靠数据传输服务，两个进程通信前没有握手过程。



## 四、应用层协议

应用层协议定义了以下规则：

1.交换的报文类型，例如请求报文和响应报文

2.各种报文类型的语法

3.字段的语义

4.确定一个进程何时以及如何发送报文，对报文进行响应的规则



## 五、HTTP协议

### 非持续连接和持续连接

**非持续连接：**

每个请求/响应对由一个独立的TCP连接发送。这样的连接必须为每一个请求的对象建立和维护一个全新的连接，每个连接，在客户和服务器中都要分配TCP的缓冲区和保持TCP变量，给Web服务器带来严重的负担。其次，每一个对象会经受两倍的RTT交付时延

**持续连接：**

所有的请求即及其响应都经响应相同的TCP连接发送。



### HTTP报文

HTTP请求报文由**请求行**、**首部行**、**空行(crlf)**、**请求体**组成。HTTP请求报文的第一行叫做请求行，后继行叫做首部行。请求行有3个字段：**方法字段**、**URL字段**和**HTTP版本字段。**

首部行字段主要有以下这些：

**Connection：close**	告诉服务器不要使用持续连接

**User-agent：Mozilla/5.0**	服务器发送请求的浏览器类型

**Accept-language**	接收的语言类型

**Server**	产生报文的服务器类型，如Apache/2.2.3（CentOS）

**Last-Modified**	请求对象创建或者最后修改的日期和时间

**If-Modified-Since**	用于判断请求的对象是否在指定时间之后被修改



## 六、DNS协议

DNS协议运行在UDP之上

### DNS服务器类型

#### 根DNS服务器

根DNS服务器提供TLD服务器的IP地址

#### 顶级域（TLD,Top Level Domain)DNS服务器

对于每个顶级域(如：com、org、net、edu、gov)和所有国家的顶级域(如：uk、fr、ca、jp)提供服务。TLD服务器提供了权威DNS服务器的IP地址。

#### 权威DNS服务器

收藏了公共可访问主机的DNS记录。

#### 本地DNS服务器

每一个ISP都有一台本地DNS服务器。



### DNS提供的服务

#### 域名解析

将主机名解析成IP地址

#### 主机别名

调用DNS来获得主机别名对应的规范主机名以及主机的IP地址

#### 邮件服务器别名

调用DNS来获得邮件服务器别名对应的规范邮件服务器名以及主机的IP地址

#### 负载分配

当客户对映射到某地址集合的名字发出一个DNS请求时，该服务器用IP地址的整个集合进行响应，但在每个回答中循环这些地址次序。

### DNS缓存

在一个请求链中，当某DNS服务器接受一个DNS回答时，它能够将映射缓存在本地存储器中



## 内容分发网(CDN)

### CDN解决的问题

1.客户到服务器的分组跨越通信链路过长并经过许多ISP，导致吞吐量减少

2.数据可能经过相同的链路发送许多次，导致了网络资源的浪费

3.单点故障



### CDN操作

1.用户指定主机名发送请求到本地DNS

2.本地DNS经过根DNS服务器->TLD服务器->权威DNS服务器，将主机名解析为CDN服务器地址

3.本地DNS服务器访问CDN服务器地址，CDN服务器解析主机名，通过集群选择策略选择合适的服务器IP地址返回。集群选择策略一般为地理上最邻近的集群







